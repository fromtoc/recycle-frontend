(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d22d74c"],{f826:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"health"},[r("el-breadcrumb",{staticStyle:{"padding-left":"10px","padding-bottom":"10px","font-size":"12px"},attrs:{separator:"/"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首頁")]),r("el-breadcrumb-item",[e._v("健康報備")]),r("el-breadcrumb-item",[e._v("每日打卡")])],1),r("el-card",{staticStyle:{height:"590px"}},[e.reported?r("el-alert",{staticStyle:{"margin-bottom":"20px"},attrs:{closable:!1,"show-icon":"",title:"今日已成功打卡,勤洗手,戴口罩,不群聚,打卡時間:["+e.ruleForm.createTime+"]",type:"success"}}):e._e(),r("h5",{staticStyle:{margin:"0px",padding:"0px"}},[e._v("基本信息 "),r("div",{staticStyle:{float:"right","margin-bottom":"10px","vertical-align":"center"}},[r("el-button",{attrs:{size:"small",type:"warning"},on:{click:e.OpenHistory}},[e._v("簽到記錄")]),e.reported?e._e():r("el-button",{staticStyle:{"margin-top":"5px"},attrs:{type:"primary",size:"small"},on:{click:e.onSubmit}},[e._v("立即打卡")]),e.reported?e._e():r("el-button",{attrs:{size:"small"},on:{click:e.reset}},[e._v("重置")])],1)]),r("el-drawer",{attrs:{"with-header":!1,visible:e.drawer,direction:e.direction},on:{"update:visible":function(t){e.drawer=t}}},[r("span",[e._l(this.historyTable,(function(t){return r("el-card",{key:t.id,staticClass:"box-card",staticStyle:{"margin-bottom":"10px"}},[r("div",{staticClass:"text item"},[r("ul",[r("li",[e._v("打卡人:"+e._s(e.userInfo.username))]),r("li",[e._v("打卡位置:"+e._s(t.address))]),r("li",[e._v("打卡時間:"+e._s(t.createTime))]),r("li",[e._v("健康狀况: "),r("div",{staticStyle:{float:"right"}},[0===t.situation?r("el-tag",{attrs:{size:"small",effect:"dark",type:"success"}},[e._v("健康")]):1===t.situation?r("el-tag",{attrs:{size:"small",effect:"dark",type:"danger"}},[e._v("發熱")]):2===t.situation?r("el-tag",{attrs:{size:"small",effect:"dark",type:"warning"}},[e._v("其他情况")]):e._e()],1)])])])])})),r("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{"current-page":e.queryMap.pageNo,"page-size":e.queryMap.pageSize,background:"",small:"",layout:"prev, pager, next",total:e.historyTotal},on:{"current-change":e.handleCurrentChange}})],2)]),r("el-divider"),r("el-form",{attrs:{size:"small","label-width":"80px"}},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:8}},[r("div",{staticClass:"grid-content bg-purple"},[r("el-form-item",{attrs:{label:"打卡人"}},[r("el-input",{attrs:{disabled:""},model:{value:e.userInfo.username,callback:function(t){e.$set(e.userInfo,"username",t)},expression:"userInfo.username"}})],1)],1)]),r("el-col",{attrs:{span:8}},[r("div",{staticClass:"grid-content bg-purple"},[r("div",{staticClass:"grid-content bg-purple"},[r("el-form-item",{attrs:{label:"打卡時間"}},[r("el-date-picker",{attrs:{disabled:"",type:"datetime",placeholder:"選擇日期時間"},model:{value:e.nowTime,callback:function(t){e.nowTime=t},expression:"nowTime"}})],1)],1)])]),r("el-col",{attrs:{span:8}},[r("div",{staticClass:"grid-content bg-purple"},[r("div",{staticClass:"grid-content bg-purple"},[r("el-form-item",{attrs:{label:"所屬公司"}},[r("el-input",{attrs:{disabled:""},model:{value:e.userInfo.department,callback:function(t){e.$set(e.userInfo,"department",t)},expression:"userInfo.department"}})],1)],1)])])],1)],1),r("h5",{staticStyle:{margin:"0px",padding:"0px"}},[e._v("健康打卡")]),r("el-divider"),r("el-form",{ref:"ruleFormRef",staticClass:"demo-ruleForm",attrs:{size:"small",inline:!0,"label-position":"top",model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:6}},[r("div",{staticClass:"grid-content bg-purple"},[r("el-form-item",{attrs:{label:"省份",prop:"valueProvince"}},[r("el-select",{attrs:{disabled:e.reported,placeholder:"請選擇省"},on:{change:e.changeProvince},model:{value:e.ruleForm.valueProvince,callback:function(t){e.$set(e.ruleForm,"valueProvince",t)},expression:"ruleForm.valueProvince"}},e._l(e.provinceList,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)]),r("el-col",{attrs:{span:6}},[r("div",{staticClass:"grid-content bg-purple"},[r("el-form-item",{attrs:{label:"城市",prop:"valueCity"}},[r("el-select",{attrs:{disabled:e.reported,placeholder:"請選擇市"},on:{change:e.changeCity},model:{value:e.ruleForm.valueCity,callback:function(t){e.$set(e.ruleForm,"valueCity",t)},expression:"ruleForm.valueCity"}},e._l(e.cityOptions,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)]),r("el-col",{attrs:{span:6}},[r("div",{staticClass:"grid-content bg-purple"},[r("el-form-item",{attrs:{label:"區縣",prop:"valueOrigin"}},[r("el-select",{attrs:{disabled:e.reported,placeholder:"請選擇區"},on:{change:e.changeOrigin},model:{value:e.ruleForm.valueOrigin,callback:function(t){e.$set(e.ruleForm,"valueOrigin",t)},expression:"ruleForm.valueOrigin"}},e._l(e.originOptions,(function(e){return r("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1)],1)],1)]),r("el-col",{attrs:{span:6}},[r("div",{staticClass:"grid-content bg-purple"},[e.reported?r("el-form-item",{attrs:{label:"打卡位置",prop:"valueOrigin"}},[r("el-tag",{attrs:{size:"small"}},[e._v(" "+e._s(e.ruleForm.address)+" ")])],1):e._e()],1)])],1),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("div",{staticClass:"grid-content bg-purple"},[r("el-form-item",{attrs:{label:"目前健康狀况",prop:"situation"}},[r("el-radio-group",{attrs:{disabled:e.reported},model:{value:e.ruleForm.situation,callback:function(t){e.$set(e.ruleForm,"situation",t)},expression:"ruleForm.situation"}},[r("el-radio",{attrs:{label:0}},[e._v("健康")]),r("el-radio",{attrs:{label:1}},[e._v("有咳嗽發熱症狀")]),r("el-radio",{attrs:{label:2}},[e._v("其他情况")])],1)],1)],1)]),r("el-col",{attrs:{span:12}},[r("div",{staticClass:"grid-content bg-purple"},[r("el-form-item",{attrs:{label:"接觸的人是否有疑似症狀?  (冠狀病毒檢測结果為陽性或尚在等待檢測结構)",prop:"touch"}},[r("el-radio-group",{attrs:{disabled:e.reported},model:{value:e.ruleForm.touch,callback:function(t){e.$set(e.ruleForm,"touch",t)},expression:"ruleForm.touch"}},[r("el-radio",{attrs:{label:1}},[e._v("是")]),r("el-radio",{attrs:{label:0}},[e._v("否")])],1)],1)],1)])],1),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("div",{staticClass:"grid-content bg-purple"},[r("el-form-item",{attrs:{label:"自2020年1月1日起,是否在湖北省停留過 (保存轉車路過)",prop:"passby"}},[r("el-radio-group",{attrs:{disabled:e.reported},model:{value:e.ruleForm.passby,callback:function(t){e.$set(e.ruleForm,"passby",t)},expression:"ruleForm.passby"}},[r("el-radio",{attrs:{label:1}},[e._v("是")]),r("el-radio",{attrs:{label:0}},[e._v("否")])],1)],1)],1)]),r("el-col",{attrs:{span:12}},[r("div",{staticClass:"grid-content bg-purple"},[r("el-form-item",{attrs:{label:"自2020年1月1日起,是否有接待過来自湖北的客戶,親戚或朋友)",prop:"reception"}},[r("el-radio-group",{attrs:{disabled:e.reported},model:{value:e.ruleForm.reception,callback:function(t){e.$set(e.ruleForm,"reception",t)},expression:"ruleForm.reception"}},[r("el-radio",{attrs:{label:1}},[e._v("是")]),r("el-radio",{attrs:{label:0}},[e._v("否")])],1)],1)],1)])],1)],1)],1)],1)},a=[],l=r("1da1"),s=(r("159b"),r("d3b7"),r("25f0"),r("ac1f"),r("466d"),r("b0c0"),r("fb6a"),r("96cf"),{data:function(){return{drawer:!1,direction:"rtl",queryMap:{pageSize:4,pageNum:1},reported:!1,historyTable:[],historyTotal:0,provinceList:[],cityList:[],originList:[],cityOptions:[],originOptions:[],ruleForm:{},nowTime:new Date,userInfo:{},rules:{situation:[{required:!0,message:"請選擇當前情况",trigger:"blur"}],touch:[{required:!0,message:"請選擇是否接觸",trigger:"blur"}],passby:[{required:!0,message:"請選擇是否路過",trigger:"blur"}],reception:[{required:!0,message:"請選擇是否招待",trigger:"blur"}],valueProvince:[{required:!0,message:"請輸入省份",trigger:"blur"}],valueCity:[{required:!0,message:"請輸入城市",trigger:"blur"}],valueOrigin:[{required:!0,message:"請輸入區縣",trigger:"blur"}]}}},methods:{OpenHistory:function(){this.drawer=!0,this.reportHistory()},handleCurrentChange:function(e){this.queryMap.pageNum=e,this.reportHistory()},reportHistory:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("business/health/history",{params:e.queryMap});case 2:if(r=t.sent,i=r.data,i.success){t.next=8;break}return t.abrupt("return",e.$message.error("歷史記錄獲取失敗:"+i.msg));case 8:e.historyTable=i.data.rows,e.historyTotal=i.data.total;case 10:case"end":return t.stop()}}),t)})))()},isReport:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("business/health/isReport");case 2:if(r=t.sent,i=r.data,i.success){t.next=8;break}return t.abrupt("return",e.$message.error("今日健康報備檢查錯誤:"+i.msg));case 8:i.data?(e.reported=!0,e.ruleForm=i.data):(e.reported=!1,e.$notify.warning({title:"温馨提示",message:"您今日還未打卡,別忘記了哟~"}));case 9:case"end":return t.stop()}}),t)})))()},onSubmit:function(){var e=this;this.$refs.ruleFormRef.validate(function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(r){var i,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=4;break}return t.abrupt("return");case 4:return e.ruleForm.address=e.ruleForm.province+"/"+e.ruleForm.city+"/"+e.ruleForm.origin,t.next=7,e.$http.post("business/health/report",e.ruleForm);case 7:if(i=t.sent,a=i.data,!a.success){t.next=15;break}e.reported=!0,e.ruleForm.createTime=e.nowTime,e.$message.success("健康報備成功"),t.next=16;break;case 15:return t.abrupt("return",e.$message.error("健康報備失敗:"+a.msg));case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},reset:function(){this.$refs.ruleFormRef.clearValidate(),this.ruleForm={}},currentTime:function(){setInterval(this.getDate,500)},getDate:function(){this.nowTime=new Date},changeProvince:function(e){var t=this;this.provinceList.forEach((function(r,i){e.toString()===t.provinceList[i].value&&(t.cityOptions=t.provinceList[i].children,t.ruleForm.valueCity=t.provinceList[i].children[0].value,t.ruleForm.city=t.provinceList[i].children[0].label,t.ruleForm.valueOrigin=t.provinceList[i].children[0].children[0].value,t.ruleForm.origin=t.provinceList[i].children[0].children[0].label,t.originOptions=t.provinceList[i].children[0].children,t.ruleForm.province=t.provinceList[i].label)}))},changeCity:function(e){var t=this;this.cityList.forEach((function(r,i){e.toString()===t.cityList[i].value&&(t.originOptions=t.cityList[i].children,t.ruleForm.valueOrigin=t.cityList[i].children[0].value,t.ruleForm.city=t.cityList[i].label)}))},changeOrigin:function(e){var t=this;this.ruleForm.valueOrigin=e,this.originList.forEach((function(r,i){e.toString()===t.originList[i].value&&(t.ruleForm.origin=t.originList[i].label)})),this.$forceUpdate()},_getJsonData:function(){var e=this;this.$http.get("/json/provinces.json").then((function(t){for(var r in e.provinceList=[],e.cityList=[],e.originList=[],t.data.forEach((function(t){t.value.match(/0000$/)?e.provinceList.push({value:t.value,label:t.name,children:[]}):t.value.match(/00$/)?e.cityList.push({value:t.value,label:t.name,children:[]}):e.originList.push({value:t.value,label:t.name})})),e.provinceList)for(var i in e.cityList)e.provinceList[r].value.slice(0,2)===e.cityList[i].value.slice(0,2)&&e.provinceList[r].children.push(e.cityList[i]);for(var a in e.cityList)for(var l in e.originList)e.originList[l].value.slice(0,4)===e.cityList[a].value.slice(0,4)&&e.cityList[a].children.push(e.originList[l])}))}},created:function(){this.isReport(),this.userInfo=this.$store.state.userInfo,this._getJsonData()},mounted:function(){this.currentTime()},beforeDestroy:function(){this.getDate&&clearInterval(this.getDate)}}),n=s,o=r("2877"),u=Object(o["a"])(n,i,a,!1,null,null,null);t["default"]=u.exports}}]);
//# sourceMappingURL=chunk-2d22d74c.7f5e7a5e.js.map