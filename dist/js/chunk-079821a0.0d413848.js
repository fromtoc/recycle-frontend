(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-079821a0"],{"408a":function(e,t){var a=1..valueOf;e.exports=function(e){return a.call(e)}},"4de4":function(e,t,a){"use strict";var r=a("23e7"),s=a("b727").filter,n=a("1dde"),i=n("filter");r({target:"Array",proto:!0,forced:!i},{filter:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}})},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,a){var r=a("1d80"),s=a("577e"),n=a("5899"),i="["+n+"]",o=RegExp("^"+i+i+"*"),l=RegExp(i+i+"*$"),c=function(e){return function(t){var a=s(r(t));return 1&e&&(a=a.replace(o,"")),2&e&&(a=a.replace(l,"")),a}};e.exports={start:c(1),end:c(2),trim:c(3)}},7156:function(e,t,a){var r=a("1626"),s=a("861d"),n=a("d2bb");e.exports=function(e,t,a){var i,o;return n&&r(i=t.constructor)&&i!==a&&s(o=i.prototype)&&o!==a.prototype&&n(e,o),e}},"8ba4":function(e,t,a){var r=a("23e7"),s=a("eac5");r({target:"Number",stat:!0},{isInteger:s})},a9e3:function(e,t,a){"use strict";var r=a("83ab"),s=a("da84"),n=a("94ca"),i=a("6eeb"),o=a("1a2d"),l=a("7156"),c=a("d9b5"),d=a("c04e"),u=a("d039"),p=a("241c").f,m=a("06cf").f,g=a("9bf2").f,b=a("408a"),f=a("58a8").trim,h="Number",v=s[h],w=v.prototype,x=function(e){var t=d(e,"number");return"bigint"===typeof t?t:k(t)},k=function(e){var t,a,r,s,n,i,o,l,u=d(e,"number");if(c(u))throw TypeError("Cannot convert a Symbol value to a number");if("string"==typeof u&&u.length>2)if(u=f(u),t=u.charCodeAt(0),43===t||45===t){if(a=u.charCodeAt(2),88===a||120===a)return NaN}else if(48===t){switch(u.charCodeAt(1)){case 66:case 98:r=2,s=49;break;case 79:case 111:r=8,s=55;break;default:return+u}for(n=u.slice(2),i=n.length,o=0;o<i;o++)if(l=n.charCodeAt(o),l<48||l>s)return NaN;return parseInt(n,r)}return+u};if(n(h,!v(" 0o1")||!v("0b1")||v("+0x1"))){for(var y,C=function(e){var t=arguments.length<1?0:v(x(e)),a=this;return a instanceof C&&u((function(){b(a)}))?l(Object(t),a,C):t},P=r?p(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),$=0;P.length>$;$++)o(v,y=P[$])&&!o(C,y)&&g(C,y,m(v,y));C.prototype=w,w.constructor=C,i(s,h,C)}},b979:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"users"}},[a("el-breadcrumb",{staticStyle:{"padding-left":"10px","padding-bottom":"10px","font-size":"12px"},attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首頁")]),a("el-breadcrumb-item",[e._v("基本資料")]),a("el-breadcrumb-item",[e._v("用戶管理")])],1),a("el-card",{staticClass:"box-card"},[a("el-form",{ref:"form",attrs:{inline:!0,model:e.queryMap,"label-width":"70px",size:"small"}},[a("el-form-item",{attrs:{label:""}},[a("el-input",{attrs:{clearable:"",placeholder:"請輸入用戶名稱查詢"},on:{clear:e.searchUser},model:{value:e.queryMap.nickname,callback:function(t){e.$set(e.queryMap,"nickname",t)},expression:"queryMap.nickname"}})],1),a("el-form-item",{attrs:{label:""}},[a("el-input",{attrs:{clearable:"",placeholder:"請輸入用戶帳號查詢"},on:{clear:e.searchUser},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchUser.apply(null,arguments)}},model:{value:e.queryMap.username,callback:function(t){e.$set(e.queryMap,"username",t)},expression:"queryMap.username"}})],1),a("el-form-item",{attrs:{label:""}},[a("el-select",{attrs:{"no-data-text":"無數據",clearable:"",placeholder:"請選擇所屬公司查詢"},on:{change:e.searchUser,clear:e.searchUser},model:{value:e.queryMap.departmentId,callback:function(t){e.$set(e.queryMap,"departmentId",t)},expression:"queryMap.departmentId"}},e._l(e.departments,(function(t){return a("el-option",{key:t.id,attrs:{label:t.nickname,value:t.id}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.nickname))]),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[a("el-tag",{attrs:{size:"small",effect:"plain",type:"success"}},[e._v(" "+e._s(t.total)+"人 ")])],1)])})),1)],1),a("el-form-item",{staticStyle:{"margin-left":"20px"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.searchUser}},[e._v("查詢")])],1),a("el-form-item",{staticStyle:{float:"right"}},[a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"user:add",expression:"'user:add'"}],attrs:{type:"success",icon:"el-icon-plus"},on:{click:function(t){e.addDialogVisible=!0}}},[e._v("新增")]),a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"user:export",expression:"'user:export'"}],attrs:{icon:"el-icon-download"},on:{click:e.downExcel}},[e._v("下載")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{"empty-text":"暫無數據",size:"small",data:e.userList,border:"",height:"420"}},[a("el-table-column",{attrs:{label:"序號",type:"index",index:e.getIndex,width:"50"}}),a("el-table-column",{attrs:{prop:"nickname",label:"用戶名稱",width:"110"}}),a("el-table-column",{attrs:{prop:"username",label:"用戶帳號",width:"110"}}),a("el-table-column",{attrs:{prop:"departmentName",label:"所屬公司",width:"180"}}),a("el-table-column",{attrs:{prop:"regionName",label:"區域",width:"100"}}),a("el-table-column",{attrs:{prop:"email",label:"E-mail信箱",width:"180"}}),a("el-table-column",{attrs:{prop:"isban",label:"停用",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{on:{change:function(a){return e.changUserStatus(t.row)}},model:{value:t.row.status,callback:function(a){e.$set(t.row,"status",a)},expression:"scope.row.status"}})]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"user:edit",expression:"'user:edit'"}],attrs:{type:"text",size:"small",icon:"el-icon-edit"},on:{click:function(a){return e.edit(t.row.id)}}},[e._v("編輯")]),a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"user:assign",expression:"'user:assign'"}],attrs:{type:"text",size:"small",icon:"el-icon-edit"},on:{click:function(a){return e.assignRoles(t.row.id)}}},[e._v("分配角色")]),a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"user:changePassword",expression:"'user:changePassword'"}],attrs:{type:"text",size:"small",icon:"el-icon-edit"},on:{click:function(a){return e.resetPwd(t.row.id)}}},[e._v("重設密碼")]),a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"card:manage",expression:"'card:manage'"}],attrs:{type:"text",size:"small",icon:"el-icon-edit"},on:{click:function(a){return e.cardManage(t.row.id)}}},[e._v("卡片管理")])]}}])})],1),a("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{background:"","current-page":e.queryMap.pageNo,"page-sizes":[7,10,20,30],"page-size":e.queryMap.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("el-dialog",{attrs:{title:"新增用戶",visible:e.addDialogVisible,width:"50%;"},on:{close:e.closeDialog,"update:visible":function(t){e.addDialogVisible=t}}},[a("span",[a("el-form",{ref:"addFormRef",attrs:{model:e.addForm,"label-position":e.labelPosition,rules:e.addFormRules,"label-width":"80px"}},[a("el-row",[a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple-light"},[a("el-form-item",{attrs:{label:"所屬公司",prop:"departmentId"}},[a("el-select",{attrs:{"no-data-text":"無數據",placeholder:"請選擇所屬公司"},model:{value:e.addForm.departmentId,callback:function(t){e.$set(e.addForm,"departmentId",t)},expression:"addForm.departmentId"}},e._l(e.departments,(function(e){return a("el-option",{key:e.id,attrs:{label:e.nickname,value:e.id}})})),1)],1)],1)]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-form-item",{attrs:{label:"區域",prop:"regionId"}},[a("el-select",{attrs:{"no-data-text":"無數據",placeholder:"請選擇區域"},model:{value:e.addForm.regionId,callback:function(t){e.$set(e.addForm,"regionId",t)},expression:"addForm.regionId"}},e._l(e.regions,(function(e){return a("el-option",{key:e.id,attrs:{label:e.value,value:e.id}})})),1)],1)],1)])],1),a("el-row",[a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-form-item",{attrs:{label:"用戶帳號",prop:"username"}},[a("el-input",{model:{value:e.addForm.username,callback:function(t){e.$set(e.addForm,"username",t)},expression:"addForm.username"}})],1)],1)]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-form-item",{attrs:{label:"用戶名稱",prop:"nickname"}},[a("el-input",{model:{value:e.addForm.nickname,callback:function(t){e.$set(e.addForm,"nickname",t)},expression:"addForm.nickname"}})],1)],1)])],1),a("el-form-item",{attrs:{label:"E-mail",prop:"email"}},[a("el-input",{model:{value:e.addForm.email,callback:function(t){e.$set(e.addForm,"email",t)},expression:"addForm.email"}})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",loading:e.btnLoading,disabled:e.btnDisabled},on:{click:e.addUser}},[e._v("確 定")])],1)]),a("el-dialog",{attrs:{title:"編輯用戶",visible:e.editDialogVisible,width:"50%"},on:{"update:visible":function(t){e.editDialogVisible=t},close:e.editClose}},[a("span",[a("el-form",{ref:"editFormRef",attrs:{model:e.editForm,"label-position":e.labelPosition,rules:e.addFormRules,"label-width":"80px"}},[a("el-row",[a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple-light"},[a("el-form-item",{attrs:{label:"所屬公司",prop:"departmentId"}},[a("el-select",{attrs:{"no-data-text":"無數據",placeholder:"請選擇所屬公司"},model:{value:e.editForm.departmentId,callback:function(t){e.$set(e.editForm,"departmentId",t)},expression:"editForm.departmentId"}},e._l(e.departments,(function(e){return a("el-option",{key:e.id,attrs:{label:e.nickname,value:e.id}})})),1)],1)],1)]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-form-item",{attrs:{label:"區域",prop:"regionId"}},[a("el-select",{attrs:{"no-data-text":"無數據",placeholder:"請選擇區域"},model:{value:e.editForm.regionId,callback:function(t){e.$set(e.editForm,"regionId",t)},expression:"editForm.regionId"}},e._l(e.regions,(function(e){return a("el-option",{key:e.id,attrs:{label:e.value,value:e.id}})})),1)],1)],1)])],1),a("el-row",[a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-form-item",{attrs:{label:"用戶帳號",prop:"username"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.editForm.username,callback:function(t){e.$set(e.editForm,"username",t)},expression:"editForm.username"}}),a("el-input",{staticStyle:{display:"none"},attrs:{type:"hidden",disabled:!0},model:{value:e.editForm.id,callback:function(t){e.$set(e.editForm,"id",t)},expression:"editForm.id"}})],1)],1)]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-form-item",{attrs:{label:"用戶名稱",prop:"nickname"}},[a("el-input",{model:{value:e.editForm.nickname,callback:function(t){e.$set(e.editForm,"nickname",t)},expression:"editForm.nickname"}})],1)],1)]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-form-item",{attrs:{label:"E-mail",prop:"email"}},[a("el-input",{model:{value:e.editForm.email,callback:function(t){e.$set(e.editForm,"email",t)},expression:"editForm.email"}})],1)],1)])],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",loading:e.btnLoading,disabled:e.btnDisabled},on:{click:e.updateUser}},[e._v("確 定")])],1)]),a("el-dialog",{attrs:{center:"",title:"分配角色",visible:e.assignDialogVisible,width:"49%"},on:{"update:visible":function(t){e.assignDialogVisible=t}}},[a("span",[[a("el-transfer",{attrs:{"filter-placeholder":"請輸入搜索內容",filterable:"",titles:["未擁有","已擁有"],"button-texts":["到左邊","到右邊"],data:e.roles},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})]],2),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"el-icon-close",on:{click:function(t){e.assignDialogVisible=!1}}},[e._v("取消分配")]),a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"user:assign",expression:"'user:assign'"}],staticClass:"el-icon-check",attrs:{type:"primary",loading:e.btnLoading,disabled:e.btnDisabled},on:{click:e.doAssignRoles}},[e._v("確定分配")])],1)]),a("el-dialog",{attrs:{center:"",title:"卡片管理",visible:e.cardManagementVisible,width:"50%"},on:{"update:visible":function(t){e.cardManagementVisible=t}}},[a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"user:add",expression:"'user:add'"}],staticStyle:{float:"right","margin-bottom":"10px"},attrs:{size:"small",type:"success",icon:"el-icon-plus"},on:{click:function(t){e.addCardDialogVisible=!0}}},[e._v("新增")]),a("div",{staticStyle:{float:"right","margin-right":"10px"}},[a("span",{staticStyle:{"margin-right":"5px"}},[e._v("顯示停用")]),a("el-switch",{model:{value:e.showCardStop,callback:function(t){e.showCardStop=t},expression:"showCardStop"}})],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{"empty-text":"暫無數據",size:"small",data:e.cardListFilter,border:"",height:"420"}},[a("el-table-column",{attrs:{prop:"cardName",label:"過磅卡號",width:"200"}}),a("el-table-column",{attrs:{prop:"departmentCategoryName",label:"公司類型",width:"100"}}),a("el-table-column",{attrs:{prop:"departmentName",label:"公司名稱",width:"100"}}),a("el-table-column",{attrs:{prop:"regionName",label:"區域位置",width:"100"}}),a("el-table-column",{attrs:{prop:"isban",label:"停用",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{on:{change:function(a){return e.changCardStatus(t.row)}},model:{value:t.row.status,callback:function(a){e.$set(t.row,"status",a)},expression:"scope.row.status"}})]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-edit"},on:{click:function(a){return e.assignCardProduct(t.row.id)}}},[e._v("編輯")])]}}])})],1)],1),a("el-dialog",{attrs:{title:"新增卡片",visible:e.addCardDialogVisible,width:"50%"},on:{"update:visible":function(t){e.addCardDialogVisible=t}}},[a("span",[a("el-form",{staticClass:"demo-ruleForm",attrs:{"label-width":"140px"}},[a("el-form-item",{attrs:{label:"輸入卡片號碼",prop:"addCardId"}},[a("el-input",{attrs:{type:"text"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addCard.apply(null,arguments)}},model:{value:e.addCardId,callback:function(t){e.addCardId=t},expression:"addCardId"}})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addCardDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.addCard}},[e._v("確 定")])],1)]),a("el-dialog",{attrs:{center:"",title:"分配廢棄物",visible:e.assignCardProdcutsDialogVisible,width:"49%"},on:{"update:visible":function(t){e.assignCardProdcutsDialogVisible=t}}},[a("span",[[a("el-transfer",{attrs:{"filter-placeholder":"請輸入搜索內容",filterable:"",titles:["未擁有","已擁有"],"button-texts":["到左邊","到右邊"],data:e.products},model:{value:e.cardProductsValue,callback:function(t){e.cardProductsValue=t},expression:"cardProductsValue"}})]],2),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"el-icon-close",on:{click:function(t){e.assignCardProdcutsDialogVisible=!1}}},[e._v("取消分配")]),a("el-button",{staticClass:"el-icon-check",attrs:{type:"primary",loading:e.btnLoading,disabled:e.btnDisabled},on:{click:e.doAssignCardProduct}},[e._v("確定分配")])],1)]),a("el-dialog",{attrs:{title:"重設密碼",visible:e.resetPwdDialogVisable,width:"50%"},on:{"update:visible":function(t){e.resetPwdDialogVisable=t}}},[a("span",[a("el-form",{staticClass:"demo-ruleForm",attrs:{"label-width":"140px"}},[a("el-form-item",{attrs:{label:"輸入新密碼",prop:"newPassword"}},[a("el-input",{attrs:{type:"password"},model:{value:e.newPassword,callback:function(t){e.newPassword=t},expression:"newPassword"}})],1),a("el-form-item",{attrs:{label:"再次輸入新密碼"}},[a("el-input",{attrs:{type:"password"},model:{value:e.newPasswordAgain,callback:function(t){e.newPasswordAgain=t},expression:"newPasswordAgain"}})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.resetPwdDialogVisable=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.changePassword}},[e._v("確 定")])],1)])],1)],1)},s=[],n=a("1da1"),i=(a("96cf"),a("8ba4"),a("a9e3"),a("4de4"),a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861"),a("bc3a")),o=a.n(i),l={data:function(){return{showCardStop:!1,regions:[],btnLoading:!1,btnDisabled:!1,departments:[],loading:!0,total:0,addDialogVisible:!1,editDialogVisible:!1,assignDialogVisible:!1,cardManagementVisible:!1,addCardDialogVisible:!1,assignCardProdcutsDialogVisible:!1,resetPwdDialogVisable:!1,labelPosition:"right",queryMap:{pageNum:1,pageSize:7,username:"",sex:"",nickname:""},userList:[],cardList:[],addForm:{username:"",nickname:"",password:"",email:"",phoneNumber:"",sex:"",birth:""},editForm:{},addCardUserId:"",addCardId:"",changePasswordUserId:"",newPassword:"",newPasswordAgain:"",addFormRules:{username:[{required:!0,message:"請輸入用戶帳號",trigger:"blur"}],departmentId:[{required:!0,message:"請選擇所屬公司",trigger:"blur"}],email:[{required:!0,message:"請輸入E-mail",trigger:"blur"}],nickname:[{required:!0,message:"請輸入用戶名稱",trigger:"blur"}],regionId:[{required:!0,message:"請選擇區域",trigger:"blur"}]},roles:[],value:[],uid:"",products:[],cardProductsValue:[],cid:""}},computed:{cardListFilter:function(){return this.showCardStop?this.cardList.filter((function(e){return 1==e.status})):this.cardList.filter((function(e){return!0!==e.status}))}},methods:{getIndex:function(e){return(this.queryMap.pageNum-1)*this.queryMap.pageSize+e+1},reset:function(){this.queryMap={pageNum:1,pageSize:7,username:"",sex:"",nickname:""}},downExcel:function(){var e=this;o.a.request({url:"system/user/excel",method:"post",responseType:"blob"}).then((function(t){if("application/json"===t.headers["content-type"])return e.$message.error("Subject does not have permission [user:export]");var a=t.data,r=window.URL.createObjectURL(a),s=document.createElement("a");document.body.appendChild(s),s.href=r,s.download="用戶列表.xls",s.click(),window.URL.revokeObjectURL(r)}))},assignRoles:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var r,s,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=t.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),a.next=3,t.$http.get("system/user/"+e+"/roles");case 3:s=a.sent,n=s.data,n.success?(t.roles=n.data.roles,t.value=n.data.values,t.uid=e,setTimeout((function(){r.close(),t.assignDialogVisible=!0}),400)):t.$message.error("分配角色失敗:"+n.data.errorMsg);case 6:case"end":return a.stop()}}),a)})))()},doAssignRoles:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.assignDialogVisible=!0,e.btnLoading=!0,e.btnDisabled=!0,t.next=5,e.$http.post("system/user/"+e.uid+"/assignRoles",e.value);case 5:a=t.sent,r=a.data,r.success?e.$notify.success({title:"操作成功",message:"用戶分配角色成功"}):e.$message.error("分配角色失敗:"+r.data.errorMsg),e.assignDialogVisible=!1,e.btnLoading=!1,e.btnDisabled=!1;case 11:case"end":return t.stop()}}),t)})))()},assignCardProduct:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var r,s,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=t.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),a.next=3,t.$http.get("system/user/card/"+e+"/products");case 3:s=a.sent,n=s.data,n.success?(t.products=n.data.products,t.cardProductsValue=n.data.values,t.cid=e,setTimeout((function(){r.close(),t.assignCardProdcutsDialogVisible=!0}),400)):t.$message.error("分配角色失敗:"+n.data.errorMsg);case 6:case"end":return a.stop()}}),a)})))()},doAssignCardProduct:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.assignCardProdcutsDialogVisible=!0,e.btnLoading=!0,e.btnDisabled=!0,t.next=5,e.$http.post("system/user/"+e.cid+"/assignProducts",e.cardProductsValue);case 5:a=t.sent,r=a.data,r.success?e.$notify.success({title:"操作成功",message:"卡片分配廢棄物成功"}):e.$message.error("分配廢棄物失敗:"+r.data.errorMsg),e.assignCardProdcutsDialogVisible=!1,e.btnLoading=!1,e.btnDisabled=!1;case 11:case"end":return t.stop()}}),t)})))()},getUserList:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("system/user/findUserList",{params:e.queryMap});case 2:if(a=t.sent,r=a.data,r.success){t.next=6;break}return t.abrupt("return",e.$message.error("獲取用戶列表失敗:"+r.data.errorMsg));case 6:e.total=r.data.total,e.userList=r.data.rows;case 8:case"end":return t.stop()}}),t)})))()},getCardList:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var r,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$http.get("system/user/card/list/"+e);case 2:if(r=a.sent,s=r.data,s.success){a.next=6;break}return a.abrupt("return",t.$message.error("獲取用戶卡片列表失敗:"+s.data.errorMsg));case 6:t.cardList=s.data,t.addCardUserId=e;case 8:case"end":return a.stop()}}),a)})))()},del:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var r,s,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$confirm("此操作將永久删除該用戶, 是否繼續?","提示",{confirmButtonText:"確定",cancelButtonText:"取消",type:"warning"}).catch((function(){t.$message({type:"info",message:"已取消删除"})}));case 2:if(r=a.sent,"confirm"!==r){a.next=18;break}return a.next=6,t.$http.delete("system/user/delete/"+e);case 6:if(s=a.sent,n=s.data,console.log(n),!n.success){a.next=17;break}return t.$notify.success({title:"操作成功",message:"用戶删除成功"}),a.next=13,t.getUserList();case 13:return a.next=15,t.getDepartmets();case 15:a.next=18;break;case 17:t.$message.error(n.data.errorMsg);case 18:case"end":return a.stop()}}),a)})))()},addUser:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.addFormRef.validate(function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(a){var r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=4;break}return t.abrupt("return");case 4:return e.btnLoading=!0,e.btnDisabled=!0,t.next=8,e.$http.post("system/user/add",e.addForm);case 8:if(r=t.sent,s=r.data,!s.success){t.next=19;break}return e.$notify.success({title:"操作成功",message:"用戶新增成功"}),e.addForm={},t.next=15,e.getUserList();case 15:return t.next=17,e.getDepartmets();case 17:t.next=20;break;case 19:return t.abrupt("return",e.$message.error("用戶新增失敗:"+s.data.errorMsg));case 20:e.addDialogVisible=!1,e.btnLoading=!1,e.btnDisabled=!1;case 23:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()},updateUser:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.editFormRef.validate(function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(a){var r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=4;break}return t.abrupt("return");case 4:return e.btnLoading=!0,e.btnDisabled=!0,t.next=8,e.$http.put("system/user/update/"+e.editForm.id,e.editForm);case 8:if(r=t.sent,s=r.data,!s.success){t.next=19;break}return e.$notify({title:"操作成功",message:"用戶基本信息已更新",type:"success"}),e.editForm={},t.next=15,e.getUserList();case 15:return t.next=17,e.getDepartmets();case 17:t.next=20;break;case 19:e.$message.error("用戶信息更新失敗:"+s.data.errorMsg);case 20:e.editDialogVisible=!1,e.btnLoading=!1,e.btnDisabled=!1;case 23:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()},resetPwd:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.resetPwdDialogVisable=!0,t.changePasswordUserId=e;case 2:case"end":return a.stop()}}),a)})))()},changePassword:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.newPassword==t.newPasswordAgain){e.next=3;break}return t.$message.error("新密碼不相同"),e.abrupt("return");case 3:return e.next=5,t.$http.put("system/user/change/password/"+t.changePasswordUserId+"/"+t.newPassword);case 5:a=e.sent,r=a.data,r.success?t.$notify({title:"操作成功",message:"用戶密碼已更新",type:"success"}):t.$message.error("用戶密碼更新失敗:"+r.data.errorMsg),t.changePasswordUserId="",t.newPassword="",t.newPasswordAgain="",t.resetPwdDialogVisable=!1;case 12:case"end":return e.stop()}}),e)})))()},addCard:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.put("system/user/card/add/"+e.addCardUserId+"/"+e.addCardId);case 2:a=t.sent,r=a.data,r.success?e.$notify({title:"操作成功",message:"用戶卡片新增成功",type:"success"}):e.$message.error("用戶卡片新增失敗:"+r.data),e.addCardId="",e.addCardDialogVisible=!1,e.getCardList(e.addCardUserId),e.addCardUserId="";case 9:case"end":return t.stop()}}),t)})))()},searchUser:function(){this.queryMap.pageNum=1,this.getUserList()},edit:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var r,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$http.get("system/user/edit/"+e);case 2:if(r=a.sent,s=r.data,!s.success){a.next=9;break}t.editForm=s.data,t.editDialogVisible=!0,a.next=10;break;case 9:return a.abrupt("return",t.$message.error("用戶信息編輯失敗:"+s.data.errorMsg));case 10:case"end":return a.stop()}}),a)})))()},handleSizeChange:function(e){this.queryMap.pageSize=e,this.getUserList()},handleCurrentChange:function(e){this.queryMap.pageNum=e,this.getUserList()},closeDialog:function(){this.$refs.addFormRef.clearValidate(),this.addForm.birth="",this.addForm={}},editClose:function(){this.$refs.editFormRef.clearValidate(),this.editForm={}},changUserStatus:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var r,s,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$http.put("system/user/updateStatus/"+e.id+"/"+e.status);case 2:r=a.sent,s=r.data,s.success?(n=e.status?"用戶狀態已禁用":"用戶狀態已啟用",t.$notify.success({title:"操作成功",message:n})):(t.$message.error("更新用戶狀態失敗:"+s.data.errorMsg),e.status=!e.status);case 5:case"end":return a.stop()}}),a)})))()},changCardStatus:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var r,s,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$http.put("system/user/updateCardStatus/"+e.id+"/"+ +e.status);case 2:r=a.sent,s=r.data,s.success?(n=e.status?"卡片已禁用":"卡片已啟用",t.$notify.success({title:"操作成功",message:n})):(t.$message.error("更新卡片狀態失敗:"+s.data.errorMsg),e.status=!e.status);case 5:case"end":return a.stop()}}),a)})))()},getDepartmets:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("system/department/findAll");case 2:if(a=t.sent,r=a.data,r.success){t.next=10;break}if("限本帳號"!=r.data.errorMsg){t.next=9;break}e.limitUser=!0,t.next=10;break;case 9:return t.abrupt("return",e.$message.error("獲取公司列表失敗:"+r.data.errorMsg));case 10:e.departments=r.data;case 11:case"end":return t.stop()}}),t)})))()},getRegion:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("system/region/findAll");case 2:if(a=t.sent,r=a.data,r.success){t.next=6;break}return t.abrupt("return",e.$message.error("獲取區域失敗:"+r.data.errorMsg));case 6:e.regions=r.data;case 7:case"end":return t.stop()}}),t)})))()},showSex:function(e,t){return 1===e.sex?"帥哥":"美女"},cardManage:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.getCardList(e),t.cardManagementVisible=!0;case 2:case"end":return a.stop()}}),a)})))()}},created:function(){var e=this;this.getUserList(),this.getDepartmets(),this.getRegion(),setTimeout((function(){e.loading=!1}),500)}},c=l,d=a("2877"),u=Object(d["a"])(c,r,s,!1,null,null,null);t["default"]=u.exports},eac5:function(e,t,a){var r=a("861d"),s=Math.floor;e.exports=Number.isInteger||function(e){return!r(e)&&isFinite(e)&&s(e)===e}}}]);
//# sourceMappingURL=chunk-079821a0.0d413848.js.map