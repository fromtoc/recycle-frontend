{"version":3,"sources":["webpack:///./src/views/business/product/category.vue?a621","webpack:///src/views/business/product/category.vue","webpack:///./src/views/business/product/category.vue?c46e","webpack:///./src/views/business/product/category.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","staticStyle","path","_v","staticClass","directives","name","rawName","value","expression","on","openAdd","downExcel","ref","categorys","columns","scopedSlots","_u","key","fn","scope","row","lev","$event","changeStatus","model","callback","$$v","$set","edit","id","queryMap","pageNum","pageSize","total","handleSizeChange","handleCurrentChange","addDialogVisible","addCloseDialog","addRuleForm","addRules","parentCategorys","selectProps","selectParentChange","clearParent","pKeys","slot","btnDisabled","btnLoading","add","editDialogVisible","editCloseDialog","editRuleForm","update","staticRenderFns","data","loading","sort","expandTrigger","label","children","methods","pid","len","newSize","getCategoryList","current","getParentCategoryList","$refs","addRuleFormRef","clearValidate","editRuleFormRef","created","setTimeout","component"],"mappings":"yHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,MAAM,CAAC,GAAK,aAAa,CAACF,EAAG,gBAAgB,CAACG,YAAY,CAAC,eAAe,OAAO,iBAAiB,OAAO,YAAY,QAAQD,MAAM,CAAC,UAAY,MAAM,CAACF,EAAG,qBAAqB,CAACE,MAAM,CAAC,GAAK,CAAEE,KAAM,WAAY,CAACR,EAAIS,GAAG,QAAQL,EAAG,qBAAqB,CAACJ,EAAIS,GAAG,WAAWL,EAAG,qBAAqB,CAACJ,EAAIS,GAAG,cAAc,GAAGL,EAAG,UAAU,CAACM,YAAY,YAAY,CAACN,EAAG,MAAM,CAACG,YAAY,CAAC,MAAQ,QAAQ,eAAe,OAAO,gBAAgB,SAAS,CAACH,EAAG,YAAY,CAACO,WAAW,CAAC,CAACC,KAAK,gBAAgBC,QAAQ,kBAAkBC,MAAM,sBAAwBC,WAAW,0BAA0BT,MAAM,CAAC,KAAO,QAAQ,KAAO,UAAU,KAAO,+BAA+BU,GAAG,CAAC,MAAQhB,EAAIiB,UAAU,CAACjB,EAAIS,GAAG,QAAQL,EAAG,YAAY,CAACO,WAAW,CAAC,CAACC,KAAK,gBAAgBC,QAAQ,kBAAkBC,MAAM,yBAA2BC,WAAW,6BAA6BT,MAAM,CAAC,KAAO,QAAQ,KAAO,oBAAoBU,GAAG,CAAC,MAAQhB,EAAIkB,YAAY,CAAClB,EAAIS,GAAG,SAAS,GAAGL,EAAG,WAAW,CAACO,WAAW,CAAC,CAACC,KAAK,UAAUC,QAAQ,YAAYC,MAAOd,EAAW,QAAEe,WAAW,YAAYI,IAAI,QAAQZ,YAAY,CAAC,aAAa,QAAQD,MAAM,CAAC,aAAa,GAAG,eAAc,EAAM,kBAAiB,EAAM,WAAW,MAAM,aAAa,KAAK,KAAON,EAAIoB,UAAU,QAAUpB,EAAIqB,SAASC,YAAYtB,EAAIuB,GAAG,CAAC,CAACC,IAAI,MAAMC,GAAG,SAASC,GAAO,MAAO,CAAoB,IAAlBA,EAAMC,IAAIC,IAAWxB,EAAG,SAAS,CAACJ,EAAIS,GAAG,UAA6B,IAAlBiB,EAAMC,IAAIC,IAAWxB,EAAG,SAAS,CAACE,MAAM,CAAC,KAAO,YAAY,CAACN,EAAIS,GAAG,UAAUL,EAAG,SAAS,CAACE,MAAM,CAAC,KAAO,WAAW,CAACN,EAAIS,GAAG,aAAa,CAACe,IAAI,QAAQC,GAAG,SAASC,GAAO,MAAO,CAACtB,EAAG,YAAY,CAACY,GAAG,CAAC,OAAS,SAASa,GAAQ,OAAO7B,EAAI8B,aAAaJ,EAAMC,OAAOI,MAAM,CAACjB,MAAOY,EAAMC,IAAU,OAAEK,SAAS,SAAUC,GAAMjC,EAAIkC,KAAKR,EAAMC,IAAK,SAAUM,IAAMlB,WAAW,yBAAyB,CAACS,IAAI,SAASC,GAAG,SAASC,GAAO,MAAO,CAACtB,EAAG,YAAY,CAACO,WAAW,CAAC,CAACC,KAAK,gBAAgBC,QAAQ,kBAAkBC,MAAM,uBAAyBC,WAAW,2BAA2BT,MAAM,CAAC,KAAO,OAAO,KAAO,QAAQ,KAAO,gBAAgBU,GAAG,CAAC,MAAQ,SAASa,GAAQ,OAAO7B,EAAImC,KAAKT,EAAMC,IAAIS,OAAO,CAACpC,EAAIS,GAAG,eAAeL,EAAG,gBAAgB,CAACG,YAAY,CAAC,aAAa,QAAQD,MAAM,CAAC,WAAa,GAAG,eAAc,EAAK,eAAeL,KAAKoC,SAASC,QAAQ,aAAa,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,IAAI,YAAYrC,KAAKoC,SAASE,SAAS,OAAS,0CAA0C,MAAQvC,EAAIwC,OAAOxB,GAAG,CAAC,cAAchB,EAAIyC,iBAAiB,iBAAiBzC,EAAI0C,uBAAuBtC,EAAG,YAAY,CAACE,MAAM,CAAC,MAAQ,UAAU,QAAUN,EAAI2C,iBAAiB,MAAQ,OAAO3B,GAAG,CAAC,iBAAiB,SAASa,GAAQ7B,EAAI2C,iBAAiBd,GAAQ,MAAQ7B,EAAI4C,iBAAiB,CAACxC,EAAG,OAAO,CAACA,EAAG,UAAU,CAACe,IAAI,iBAAiBb,MAAM,CAAC,MAAQN,EAAI6C,YAAY,MAAQ7C,EAAI8C,SAAS,cAAc,UAAU,CAAC1C,EAAG,eAAe,CAACE,MAAM,CAAC,MAAQ,OAAO,KAAO,SAAS,CAACF,EAAG,WAAW,CAAC2B,MAAM,CAACjB,MAAOd,EAAI6C,YAAgB,KAAEb,SAAS,SAAUC,GAAMjC,EAAIkC,KAAKlC,EAAI6C,YAAa,OAAQZ,IAAMlB,WAAW,uBAAuB,GAAGX,EAAG,eAAe,CAACE,MAAM,CAAC,MAAQ,MAAM,KAAO,QAAQ,CAACF,EAAG,cAAc,CAACG,YAAY,CAAC,MAAQ,QAAQD,MAAM,CAAC,YAAc,MAAM,oBAAmB,EAAK,QAAUN,EAAI+C,gBAAgB,UAAY,GAAG,WAAa,GAAG,MAAQ/C,EAAIgD,aAAahC,GAAG,CAAC,OAAShB,EAAIiD,mBAAmB,MAAQjD,EAAIkD,aAAanB,MAAM,CAACjB,MAAOd,EAAS,MAAEgC,SAAS,SAAUC,GAAMjC,EAAImD,MAAMlB,GAAKlB,WAAW,YAAY,GAAGX,EAAG,eAAe,CAACE,MAAM,CAAC,MAAQ,KAAK,KAAO,WAAW,CAACF,EAAG,WAAW,CAACE,MAAM,CAAC,KAAO,YAAYyB,MAAM,CAACjB,MAAOd,EAAI6C,YAAkB,OAAEb,SAAS,SAAUC,GAAMjC,EAAIkC,KAAKlC,EAAI6C,YAAa,SAAUZ,IAAMlB,WAAW,yBAAyB,GAAGX,EAAG,eAAe,CAACE,MAAM,CAAC,MAAQ,KAAK,KAAO,SAAS,CAACF,EAAG,kBAAkB,CAACE,MAAM,CAAC,IAAM,EAAE,IAAM,GAAG,MAAQ,MAAMyB,MAAM,CAACjB,MAAOd,EAAI6C,YAAgB,KAAEb,SAAS,SAAUC,GAAMjC,EAAIkC,KAAKlC,EAAI6C,YAAa,OAAQZ,IAAMlB,WAAW,uBAAuB,IAAI,IAAI,GAAGX,EAAG,OAAO,CAACM,YAAY,gBAAgBJ,MAAM,CAAC,KAAO,UAAU8C,KAAK,UAAU,CAAChD,EAAG,YAAY,CAACY,GAAG,CAAC,MAAQ,SAASa,GAAQ7B,EAAI2C,kBAAmB,KAAS,CAAC3C,EAAIS,GAAG,SAASL,EAAG,YAAY,CAACE,MAAM,CAAC,KAAO,UAAU,SAAWN,EAAIqD,YAAY,QAAUrD,EAAIsD,YAAYtC,GAAG,CAAC,MAAQhB,EAAIuD,MAAM,CAACvD,EAAIS,GAAG,UAAU,KAAKL,EAAG,YAAY,CAACE,MAAM,CAAC,MAAQ,UAAU,QAAUN,EAAIwD,kBAAkB,MAAQ,OAAOxC,GAAG,CAAC,iBAAiB,SAASa,GAAQ7B,EAAIwD,kBAAkB3B,GAAQ,MAAQ7B,EAAIyD,kBAAkB,CAACrD,EAAG,OAAO,CAACA,EAAG,UAAU,CAACe,IAAI,kBAAkBb,MAAM,CAAC,MAAQN,EAAI0D,aAAa,MAAQ1D,EAAI8C,SAAS,cAAc,UAAU,CAAC1C,EAAG,eAAe,CAACE,MAAM,CAAC,MAAQ,OAAO,KAAO,SAAS,CAACF,EAAG,WAAW,CAAC2B,MAAM,CAACjB,MAAOd,EAAI0D,aAAiB,KAAE1B,SAAS,SAAUC,GAAMjC,EAAIkC,KAAKlC,EAAI0D,aAAc,OAAQzB,IAAMlB,WAAW,wBAAwB,GAAGX,EAAG,eAAe,CAACE,MAAM,CAAC,MAAQ,KAAK,KAAO,WAAW,CAACF,EAAG,WAAW,CAACE,MAAM,CAAC,KAAO,YAAYyB,MAAM,CAACjB,MAAOd,EAAI0D,aAAmB,OAAE1B,SAAS,SAAUC,GAAMjC,EAAIkC,KAAKlC,EAAI0D,aAAc,SAAUzB,IAAMlB,WAAW,0BAA0B,GAAGX,EAAG,eAAe,CAACE,MAAM,CAAC,MAAQ,KAAK,KAAO,SAAS,CAACF,EAAG,kBAAkB,CAACE,MAAM,CAAC,IAAM,EAAE,IAAM,GAAG,MAAQ,MAAMyB,MAAM,CAACjB,MAAOd,EAAI0D,aAAiB,KAAE1B,SAAS,SAAUC,GAAMjC,EAAIkC,KAAKlC,EAAI0D,aAAc,OAAQzB,IAAMlB,WAAW,wBAAwB,IAAI,IAAI,GAAGX,EAAG,OAAO,CAACM,YAAY,gBAAgBJ,MAAM,CAAC,KAAO,UAAU8C,KAAK,UAAU,CAAChD,EAAG,YAAY,CAACY,GAAG,CAAC,MAAQ,SAASa,GAAQ7B,EAAIwD,mBAAoB,KAAS,CAACxD,EAAIS,GAAG,SAASL,EAAG,YAAY,CAACE,MAAM,CAAC,KAAO,UAAU,SAAWN,EAAIqD,YAAY,QAAUrD,EAAIsD,YAAYtC,GAAG,CAAC,MAAQhB,EAAI2D,SAAS,CAAC3D,EAAIS,GAAG,UAAU,MAAM,IAAI,IACp/KmD,EAAkB,G,+FC0LtB,GACEC,KADF,WAEI,MAAO,CACLP,YAAY,EACZD,aAAa,EACbS,SAAS,EACTX,MAAO,GACPR,kBAAkB,EAClBa,mBAAmB,EACnBE,aAAc,GACdb,YAAa,CAAnB,mCACMC,SAAU,CACRlC,KAAM,CACd,CAAU,UAAV,EAAU,QAAV,SAAU,QAAV,QACA,CACU,IAAV,EACU,IAAV,GACU,QAAV,iBACU,QAAV,SAMQmD,KAAM,CAAC,CAAf,+CAEMvB,MAAO,EACPH,SAAU,CAAhB,sBACMjB,UAAW,GACX2B,gBAAiB,GACjBC,YAAa,CACXgB,cAAe,QACflD,MAAO,KACPmD,MAAO,OACPC,SAAU,YAEZ7C,QAAS,CACf,CACQ,MAAR,OACQ,KAAR,QAEA,CACQ,MAAR,KACQ,KAAR,QAEA,CACQ,MAAR,OACQ,KAAR,cAEA,CACQ,MAAR,OACQ,KAAR,gBAEA,CACQ,MAAR,KACQ,KAAR,UAEA,CACQ,MAAR,KACQ,KAAR,MACQ,KAAR,WACQ,SAAR,OAEA,CACQ,MAAR,KACQ,KAAR,QACQ,KAAR,WACQ,SAAR,SAEA,CACQ,MAAR,KACQ,KAAR,WACQ,SAAR,aAKE8C,QAAS,CACPR,OAAQ,WAAZ,uJACA,uMACA,EADA,wDAIA,gBACA,iBALA,SAMA,YACA,qDACA,gBARA,mBAMA,EANA,EAMA,MAIA,UAVA,wBAWA,WACA,WACA,iBACA,iBAdA,UAgBA,oBAhBA,gCAkBA,8CAlBA,QAoBA,gBACA,iBACA,uBAtBA,mGADA,qGAAY,GA4BR,KA7BJ,SA6BA,mLACA,YACA,oCAFA,mBACA,EADA,EACA,MAGA,UAJA,gBAKA,sBALA,+CAOA,8CAPA,OASA,uBATA,+CAYI,IAzCJ,SAyCA,qLACA,WACA,qBACA,KACA,CACA,uBACA,sBACA,iBAEA,kBACA,YACA,YACA,qBAZA,UACA,EADA,OAeA,cAfA,iCAgBA,eACA,sCAjBA,mBAgBA,EAhBA,EAgBA,KAGA,gBACA,UApBA,wBAqBA,6BArBA,UAsBA,oBAtBA,gCAwBA,kCAxBA,+CA8BIV,mBAvEJ,WAwEM,IAAN,oBAEQhD,KAAK4C,YAAYuB,IADfC,EAAM,EACepE,KAAKkD,MAAMkB,EAAM,GAEjB,GAI3B,gBAhFJ,WAgFA,gLACA,YACA,2CACA,CACA,oBAJA,mBACA,EADA,EACA,KAMA,UAPA,yCAOA,4BAPA,OAQA,wBACA,qBATA,8CAYI,sBA5FJ,WA4FA,gLACA,YACA,kDAFA,mBACA,EADA,EACA,KAGA,UAJA,yCAKA,+CALA,OAMA,yBANA,8CASI,IArGJ,WAqGA,wJACA,mMACA,EADA,wDAIA,gBACA,iBACA,0BACA,qBAPA,SASA,aACA,+BACA,eAXA,mBASA,EATA,EASA,MAIA,UAbA,wBAcA,6BAdA,UAeA,oBAfA,yDAiBA,6CAjBA,QAmBA,sBACA,gBACA,iBArBA,mGADA,8CA6BI,aAlIJ,SAkIA,qLACA,YACA,4DAFA,gBACA,EADA,EACA,KAGA,WAIA,WACA,aACA,aACA,mBACA,aACA,cARA,iDACA,oBANA,8CAkBI5B,iBApJJ,SAoJA,GACMxC,KAAKoC,SAASE,SAAW+B,EACzBrE,KAAKsE,mBAGP7B,oBAzJJ,SAyJA,GACMzC,KAAKoC,SAASC,QAAUkC,EACxBvE,KAAKsE,mBAGPtD,QA9JJ,WA+JMhB,KAAK0C,kBAAmB,EACxB1C,KAAKwE,yBAGP7B,eAnKJ,WAoKM3C,KAAKyE,MAAMC,eAAeC,gBAC1B3E,KAAK4C,YAAc,GACnB5C,KAAKkD,MAAQ,IAEfM,gBAxKJ,WAyKMxD,KAAKyE,MAAMG,gBAAgBD,gBAC3B3E,KAAKyD,aAAe,IAEtBR,YA5KJ,WA6KMjD,KAAK4C,YAAYuB,IAAM,IAEzBlD,UA/KJ,WAgLM,IAAN,OACA,IACA,SACQ,IAAR,iCACQ,OAAR,OACQ,aAAR,SAEA,kBACQ,GAAR,+CACU,OAAV,iBACA,6DAGQ,IAAR,SACA,gCACA,8BACQ,SAAR,oBACQ,EAAR,OACQ,EAAR,uBACQ,EAAR,QACQ,OAAR,4BAIE4D,QArRF,WAqRA,WACI7E,KAAKsE,kBAELQ,YAAW,WACT,EAAN,aACA,OCrdgX,I,YCO5WC,EAAY,eACd,EACAjF,EACA6D,GACA,EACA,KACA,KACA,MAIa,aAAAoB,E","file":"js/chunk-2d0aab45.af8107b4.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"category\"}},[_c('el-breadcrumb',{staticStyle:{\"padding-left\":\"10px\",\"padding-bottom\":\"10px\",\"font-size\":\"12px\"},attrs:{\"separator\":\"/\"}},[_c('el-breadcrumb-item',{attrs:{\"to\":{ path: '/home' }}},[_vm._v(\"首頁\")]),_c('el-breadcrumb-item',[_vm._v(\"廢棄物管理\")]),_c('el-breadcrumb-item',[_vm._v(\"廢棄物類型設定\")])],1),_c('el-card',{staticClass:\"box-card\"},[_c('div',{staticStyle:{\"float\":\"right\",\"margin-right\":\"20px\",\"margin-bottom\":\"20px\"}},[_c('el-button',{directives:[{name:\"hasPermission\",rawName:\"v-hasPermission\",value:('productCategory:add'),expression:\"'productCategory:add'\"}],attrs:{\"size\":\"small\",\"type\":\"success\",\"icon\":\"el-icon-circle-plus-outline\"},on:{\"click\":_vm.openAdd}},[_vm._v(\"新增\")]),_c('el-button',{directives:[{name:\"hasPermission\",rawName:\"v-hasPermission\",value:('productCategory:export'),expression:\"'productCategory:export'\"}],attrs:{\"size\":\"small\",\"icon\":\"el-icon-download\"},on:{\"click\":_vm.downExcel}},[_vm._v(\"下載\")])],1),_c('zk-table',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],ref:\"table\",staticStyle:{\"margin-top\":\"10px\"},attrs:{\"show-index\":\"\",\"expand-type\":false,\"selection-type\":false,\"sum-text\":\"sum\",\"index-text\":\"序號\",\"data\":_vm.categorys,\"columns\":_vm.columns},scopedSlots:_vm._u([{key:\"lev\",fn:function(scope){return [(scope.row.lev === 1)?_c('el-tag',[_vm._v(\"一級分類\")]):(scope.row.lev === 2)?_c('el-tag',{attrs:{\"type\":\"success\"}},[_vm._v(\"二級分類\")]):_c('el-tag',{attrs:{\"type\":\"danger\"}},[_vm._v(\"三級分類\")])]}},{key:\"isban\",fn:function(scope){return [_c('el-switch',{on:{\"change\":function($event){return _vm.changeStatus(scope.row)}},model:{value:(scope.row.status),callback:function ($$v) {_vm.$set(scope.row, \"status\", $$v)},expression:\"scope.row.status\"}})]}},{key:\"caozuo\",fn:function(scope){return [_c('el-button',{directives:[{name:\"hasPermission\",rawName:\"v-hasPermission\",value:('productCategory:edit'),expression:\"'productCategory:edit'\"}],attrs:{\"type\":\"text\",\"size\":\"small\",\"icon\":\"el-icon-edit\"},on:{\"click\":function($event){return _vm.edit(scope.row.id)}}},[_vm._v(\"編輯\")])]}}])}),_c('el-pagination',{staticStyle:{\"margin-top\":\"10px\"},attrs:{\"background\":\"\",\"show-header\":true,\"current-page\":this.queryMap.pageNum,\"page-sizes\":[5, 10, 15, 20, 25, 30],\"page-size\":this.queryMap.pageSize,\"layout\":\"total, sizes, prev, pager, next, jumper\",\"total\":_vm.total},on:{\"size-change\":_vm.handleSizeChange,\"current-change\":_vm.handleCurrentChange}}),_c('el-dialog',{attrs:{\"title\":\"新增廢棄物分類\",\"visible\":_vm.addDialogVisible,\"width\":\"50%\"},on:{\"update:visible\":function($event){_vm.addDialogVisible=$event},\"close\":_vm.addCloseDialog}},[_c('span',[_c('el-form',{ref:\"addRuleFormRef\",attrs:{\"model\":_vm.addRuleForm,\"rules\":_vm.addRules,\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"label\":\"分類名稱\",\"prop\":\"name\"}},[_c('el-input',{model:{value:(_vm.addRuleForm.name),callback:function ($$v) {_vm.$set(_vm.addRuleForm, \"name\", $$v)},expression:\"addRuleForm.name\"}})],1),_c('el-form-item',{attrs:{\"label\":\"父分類\",\"prop\":\"pid\"}},[_c('el-cascader',{staticStyle:{\"width\":\"100%\"},attrs:{\"placeholder\":\"請選擇\",\"change-on-select\":true,\"options\":_vm.parentCategorys,\"clearable\":\"\",\"filterable\":\"\",\"props\":_vm.selectProps},on:{\"change\":_vm.selectParentChange,\"clear\":_vm.clearParent},model:{value:(_vm.pKeys),callback:function ($$v) {_vm.pKeys=$$v},expression:\"pKeys\"}})],1),_c('el-form-item',{attrs:{\"label\":\"備註\",\"prop\":\"remark\"}},[_c('el-input',{attrs:{\"type\":\"textarea\"},model:{value:(_vm.addRuleForm.remark),callback:function ($$v) {_vm.$set(_vm.addRuleForm, \"remark\", $$v)},expression:\"addRuleForm.remark\"}})],1),_c('el-form-item',{attrs:{\"label\":\"排序\",\"prop\":\"sort\"}},[_c('el-input-number',{attrs:{\"min\":1,\"max\":30,\"label\":\"排序\"},model:{value:(_vm.addRuleForm.sort),callback:function ($$v) {_vm.$set(_vm.addRuleForm, \"sort\", $$v)},expression:\"addRuleForm.sort\"}})],1)],1)],1),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.addDialogVisible = false}}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"disabled\":_vm.btnDisabled,\"loading\":_vm.btnLoading},on:{\"click\":_vm.add}},[_vm._v(\"確 定\")])],1)]),_c('el-dialog',{attrs:{\"title\":\"編輯廢棄物分類\",\"visible\":_vm.editDialogVisible,\"width\":\"50%\"},on:{\"update:visible\":function($event){_vm.editDialogVisible=$event},\"close\":_vm.editCloseDialog}},[_c('span',[_c('el-form',{ref:\"editRuleFormRef\",attrs:{\"model\":_vm.editRuleForm,\"rules\":_vm.addRules,\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"label\":\"分類名稱\",\"prop\":\"name\"}},[_c('el-input',{model:{value:(_vm.editRuleForm.name),callback:function ($$v) {_vm.$set(_vm.editRuleForm, \"name\", $$v)},expression:\"editRuleForm.name\"}})],1),_c('el-form-item',{attrs:{\"label\":\"備註\",\"prop\":\"remark\"}},[_c('el-input',{attrs:{\"type\":\"textarea\"},model:{value:(_vm.editRuleForm.remark),callback:function ($$v) {_vm.$set(_vm.editRuleForm, \"remark\", $$v)},expression:\"editRuleForm.remark\"}})],1),_c('el-form-item',{attrs:{\"label\":\"排序\",\"prop\":\"sort\"}},[_c('el-input-number',{attrs:{\"min\":1,\"max\":30,\"label\":\"排序\"},model:{value:(_vm.editRuleForm.sort),callback:function ($$v) {_vm.$set(_vm.editRuleForm, \"sort\", $$v)},expression:\"editRuleForm.sort\"}})],1)],1)],1),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.editDialogVisible = false}}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"disabled\":_vm.btnDisabled,\"loading\":_vm.btnLoading},on:{\"click\":_vm.update}},[_vm._v(\"確 定\")])],1)])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div id=\"category\">\n    <!-- 面包導航 -->\n    <el-breadcrumb\n      separator=\"/\"\n      style=\"padding-left: 10px; padding-bottom: 10px; font-size: 12px\"\n    >\n      <el-breadcrumb-item :to=\"{ path: '/home' }\">首頁</el-breadcrumb-item>\n      <el-breadcrumb-item>廢棄物管理</el-breadcrumb-item>\n      <el-breadcrumb-item>廢棄物類型設定</el-breadcrumb-item>\n    </el-breadcrumb>\n    <el-card class=\"box-card\">\n      <div style=\"float: right; margin-right: 20px; margin-bottom: 20px\">\n        <el-button\n          size=\"small\"\n          v-hasPermission=\"'productCategory:add'\"\n          type=\"success\"\n          icon=\"el-icon-circle-plus-outline\"\n          @click=\"openAdd\"\n          >新增</el-button\n        >\n        <el-button\n          size=\"small\"\n          icon=\"el-icon-download\"\n          v-hasPermission=\"'productCategory:export'\"\n          @click=\"downExcel\"\n          >下載</el-button\n        >\n      </div>\n      <!-- 表格部分 -->\n      <zk-table\n        v-loading=\"loading\"\n        style=\"margin-top: 10px\"\n        ref=\"table\"\n        show-index\n        :expand-type=\"false\"\n        :selection-type=\"false\"\n        sum-text=\"sum\"\n        index-text=\"序號\"\n        :data=\"categorys\"\n        :columns=\"columns\"\n      >\n        <!-- 層級 -->\n        <template slot=\"lev\" slot-scope=\"scope\">\n          <el-tag v-if=\"scope.row.lev === 1\">一級分類</el-tag>\n          <el-tag type=\"success\" v-else-if=\"scope.row.lev === 2\"\n            >二級分類</el-tag\n          >\n          <el-tag type=\"danger\" v-else>三級分類</el-tag>\n        </template>\n        <template slot=\"isban\" slot-scope=\"scope\">\n          <el-switch\n            v-model=\"scope.row.status\"\n            @change=\"changeStatus(scope.row)\"\n          ></el-switch>\n        </template>\n        <!-- 操作 -->\n        <template slot=\"caozuo\" slot-scope=\"scope\">\n          <el-button\n            v-hasPermission=\"'productCategory:edit'\"\n            type=\"text\"\n            size=\"small\"\n            icon=\"el-icon-edit\"\n            @click=\"edit(scope.row.id)\"\n            >編輯</el-button\n          >\n        </template>\n      </zk-table>\n      <!-- 分頁 -->\n      <el-pagination\n        style=\"margin-top: 10px\"\n        background\n        :show-header=\"true\"\n        @size-change=\"handleSizeChange\"\n        @current-change=\"handleCurrentChange\"\n        :current-page=\"this.queryMap.pageNum\"\n        :page-sizes=\"[5, 10, 15, 20, 25, 30]\"\n        :page-size=\"this.queryMap.pageSize\"\n        layout=\"total, sizes, prev, pager, next, jumper\"\n        :total=\"total\"\n      ></el-pagination>\n      <!-- 新增彈出框 -->\n      <el-dialog\n        title=\"新增廢棄物分類\"\n        :visible.sync=\"addDialogVisible\"\n        @close=\"addCloseDialog\"\n        width=\"50%\"\n      >\n        <span>\n          <el-form\n            :model=\"addRuleForm\"\n            :rules=\"addRules\"\n            ref=\"addRuleFormRef\"\n            label-width=\"100px\"\n          >\n            <el-form-item label=\"分類名稱\" prop=\"name\">\n              <el-input v-model=\"addRuleForm.name\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"父分類\" prop=\"pid\">\n              <el-cascader\n                placeholder=\"請選擇\"\n                @change=\"selectParentChange\"\n                @clear=\"clearParent\"\n                :change-on-select=\"true\"\n                :options=\"parentCategorys\"\n                clearable\n                filterable\n                style=\"width: 100%\"\n                :props=\"selectProps\"\n                v-model=\"pKeys\"\n              ></el-cascader>\n            </el-form-item>\n            <el-form-item label=\"備註\" prop=\"remark\">\n              <el-input type=\"textarea\" v-model=\"addRuleForm.remark\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"排序\" prop=\"sort\">\n              <el-input-number\n                v-model=\"addRuleForm.sort\"\n                :min=\"1\"\n                :max=\"30\"\n                label=\"排序\"\n              ></el-input-number>\n            </el-form-item>\n          </el-form>\n        </span>\n        <span slot=\"footer\" class=\"dialog-footer\">\n          <el-button @click=\"addDialogVisible = false\">取 消</el-button>\n          <el-button\n            type=\"primary\"\n            @click=\"add\"\n            :disabled=\"btnDisabled\"\n            :loading=\"btnLoading\"\n            >確 定</el-button\n          >\n        </span>\n      </el-dialog>\n      <!-- 編輯彈出框 -->\n      <el-dialog\n        title=\"編輯廢棄物分類\"\n        :visible.sync=\"editDialogVisible\"\n        @close=\"editCloseDialog\"\n        width=\"50%\"\n      >\n        <span>\n          <el-form\n            :model=\"editRuleForm\"\n            :rules=\"addRules\"\n            ref=\"editRuleFormRef\"\n            label-width=\"100px\"\n          >\n            <el-form-item label=\"分類名稱\" prop=\"name\">\n              <el-input v-model=\"editRuleForm.name\"></el-input>\n            </el-form-item>\n\n            <el-form-item label=\"備註\" prop=\"remark\">\n              <el-input\n                type=\"textarea\"\n                v-model=\"editRuleForm.remark\"\n              ></el-input>\n            </el-form-item>\n            <el-form-item label=\"排序\" prop=\"sort\">\n              <el-input-number\n                v-model=\"editRuleForm.sort\"\n                :min=\"1\"\n                :max=\"30\"\n                label=\"排序\"\n              ></el-input-number>\n            </el-form-item>\n          </el-form>\n        </span>\n        <span slot=\"footer\" class=\"dialog-footer\">\n          <el-button @click=\"editDialogVisible = false\">取 消</el-button>\n          <el-button\n            type=\"primary\"\n            @click=\"update\"\n            :disabled=\"btnDisabled\"\n            :loading=\"btnLoading\"\n            >確 定</el-button\n          >\n        </span>\n      </el-dialog>\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nexport default {\n  data() {\n    return {\n      btnLoading: false,\n      btnDisabled: false,\n      loading: true,\n      pKeys: [],\n      addDialogVisible: false,\n      editDialogVisible: false,\n      editRuleForm: [],\n      addRuleForm: { pid: \"0\", name: \"\", remark: \"\", sort: \"\" }, //新增表單\n      addRules: {\n        name: [\n          { required: true, message: \"請輸入分類名\", trigger: \"blur\" },\n          {\n            min: 2,\n            max: 30,\n            message: \"長度在 2 到 30 個字符\",\n            trigger: \"blur\",\n          },\n        ],\n        // remark: [\n        //   { required: true, message: \"請輸入備註信息\", trigger: \"blur\" },\n        // ],\n        sort: [{ required: true, message: \"請輸入排序號\", trigger: \"blur\" }],\n      },\n      total: 0,\n      queryMap: { pageNum: 1, pageSize: 5 },\n      categorys: [],\n      parentCategorys: [],\n      selectProps: {\n        expandTrigger: \"hover\",\n        value: \"id\",\n        label: \"name\",\n        children: \"children\",\n      }, //級聯選擇器配置项\n      columns: [\n        {\n          label: \"分類名稱\",\n          prop: \"name\",\n        },\n        {\n          label: \"排序\",\n          prop: \"sort\",\n        },\n        {\n          label: \"創建時間\",\n          prop: \"createTime\",\n        },\n        {\n          label: \"修改時間\",\n          prop: \"modifiedTime\",\n        },\n        {\n          label: \"備註\",\n          prop: \"remark\",\n        },\n        {\n          label: \"層級\",\n          prop: \"lev\",\n          type: \"template\",\n          template: \"lev\",\n        },\n        {\n          label: \"停用\",\n          prop: \"isban\",\n          type: \"template\",\n          template: \"isban\",\n        },\n        {\n          label: \"操作\",\n          type: \"template\",\n          template: \"caozuo\",\n        },\n      ],\n    };\n  },\n  methods: {\n    update: async function () {\n      this.$refs.editRuleFormRef.validate(async (valid) => {\n        if (!valid) {\n          return;\n        } else {\n          this.btnLoading = true;\n          this.btnDisabled = true;\n          const { data: res } = await this.$http.put(\n            \"business/productCategory/update/\" + this.editRuleForm.id,\n            this.editRuleForm\n          );\n          if (res.success) {\n            this.$notify({\n              title: \"成功\",\n              message: \"分類信息更新\",\n              type: \"success\",\n            });\n            await this.getCategoryList();\n          } else {\n            this.$message.error(\"分類信息更新失敗:\" + res.data.errorMsg);\n          }\n          this.btnLoading = false;\n          this.btnDisabled = false;\n          this.editDialogVisible = false;\n        }\n      });\n    },\n    //修改\n    async edit(id) {\n      const { data: res } = await this.$http.get(\n        \"business/productCategory/edit/\" + id\n      );\n      if (res.success) {\n        this.editRuleForm = res.data;\n      } else {\n        return this.$message.error(\"分類信息編輯失敗\" + res.data.errorMsg);\n      }\n      this.editDialogVisible = true;\n    },\n    //删除分類\n    async del(id) {\n      const res = await this.$confirm(\n        \"此操作將永久删除該分類, 是否繼續?\",\n        \"提示\",\n        {\n          confirmButtonText: \"確定\",\n          cancelButtonText: \"取消\",\n          type: \"warning\",\n        }\n      ).catch(() => {\n        this.$message({\n          type: \"info\",\n          message: \"已取消删除\",\n        });\n      });\n      if (res === \"confirm\") {\n        const { data: res } = await this.$http.delete(\n          \"business/productCategory/delete/\" + id\n        );\n        console.log(res);\n        if (res.success) {\n          this.$message.success(\"分類删除成功\");\n          await this.getCategoryList();\n        } else {\n          this.$message.error(res.data.errorMsg);\n        }\n      }\n    },\n\n    //父級分類中改變\n    selectParentChange() {\n      const len = this.pKeys.length;\n      if (len > 0) {\n        this.addRuleForm.pid = this.pKeys[len - 1];\n      } else {\n        this.addRuleForm.pid = 0;\n      }\n    },\n    //加載分類數據\n    async getCategoryList() {\n      const { data: res } = await this.$http.get(\n        \"business/productCategory/categoryTreeAll\",\n        {\n          params: this.queryMap,\n        }\n      );\n      if (!res.success) return this.$message.error(\"分類列表失敗\");\n      this.categorys = res.data.rows;\n      this.total = res.data.total;\n    },\n    //加載父級分類數據\n    async getParentCategoryList() {\n      const { data: res } = await this.$http.get(\n        \"business/productCategory/getParentCategoryTree\"\n      );\n      if (!res.success)\n        return this.$message.error(\"父級分類列表失敗:\" + res.data.errorMsg);\n      this.parentCategorys = res.data;\n    },\n    //新增分類\n    async add() {\n      this.$refs.addRuleFormRef.validate(async (valid) => {\n        if (!valid) {\n          return;\n        } else {\n          this.btnLoading = true;\n          this.btnDisabled = true;\n          if (this.addRuleForm.pid == null) {\n            this.addRuleForm.pid = 0;\n          }\n          const { data: res } = await this.$http.post(\n            \"business/productCategory/add\",\n            this.addRuleForm\n          );\n          if (res.success) {\n            this.$message.success(\"分類新增成功\");\n            await this.getCategoryList();\n          } else {\n            return this.$message.error(\"分類新增失敗:\" + res.data.errorMsg);\n          }\n          this.addDialogVisible = false;\n          this.btnLoading = false;\n          this.btnDisabled = false;\n        }\n      });\n    },\n    /**\n     * 禁用啟用廢棄物類型\n     */\n    async changeStatus(row) {\n      const { data: res } = await this.$http.put(\n        \"business/productCategory/updateStatus/\" + row.id + \"/\" + row.status\n      );\n      if (!res.success) {\n        this.$message.error(\"更新廢棄物類型狀態失敗:\" + res.data.errorMsg);\n        row.status = !row.status;\n      } else {\n        const message = row.status\n          ? \"廢棄物類型狀態已禁用\"\n          : \"廢棄物類型狀態已啟用\";\n        this.$notify.success({\n          title: \"操作成功\",\n          message: message,\n        });\n      }\n    },\n    //改變頁碼\n    handleSizeChange(newSize) {\n      this.queryMap.pageSize = newSize;\n      this.getCategoryList();\n    },\n    //翻頁\n    handleCurrentChange(current) {\n      this.queryMap.pageNum = current;\n      this.getCategoryList();\n    },\n    //打開新增\n    openAdd() {\n      this.addDialogVisible = true;\n      this.getParentCategoryList();\n    },\n    //關閉彈出框\n    addCloseDialog() {\n      this.$refs.addRuleFormRef.clearValidate();\n      this.addRuleForm = {};\n      this.pKeys = [];\n    },\n    editCloseDialog() {\n      this.$refs.editRuleFormRef.clearValidate();\n      this.editRuleForm = {};\n    },\n    clearParent() {\n      this.addRuleForm.pid = \"\";\n    },\n    downExcel() {\n      const $this = this;\n      const res = axios\n        .request({\n          url: \"business/productCategory/excel\",\n          method: \"post\",\n          responseType: \"blob\",\n        })\n        .then((res) => {\n          if (res.headers[\"content-type\"] === \"application/json\") {\n            return $this.$message.error(\n              \"Subject does not have permission [productCategory:export]\"\n            );\n          }\n          const data = res.data;\n          let url = window.URL.createObjectURL(data); // 將二進制文件轉化為可訪問的url\n          var a = document.createElement(\"a\");\n          document.body.appendChild(a);\n          a.href = url;\n          a.download = \"廢棄物類型列表.xls\";\n          a.click();\n          window.URL.revokeObjectURL(url);\n        });\n    },\n  },\n  created() {\n    this.getCategoryList();\n\n    setTimeout(() => {\n      this.loading = false;\n    }, 500);\n  },\n};\n</script>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./category.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./category.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./category.vue?vue&type=template&id=87f03554&\"\nimport script from \"./category.vue?vue&type=script&lang=js&\"\nexport * from \"./category.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}